import { Callout } from 'nextra-theme-docs'
import Image from 'next/image'

# Installing Modmail on Windows

## Prerequisites

1. Minimum 2 GB of RAM\*
2. At least 2 GB available disk space.
3. Supported Windows version:
   * Windows 10
   * Windows 11

<Callout emoji="ℹ️" type="info">
Note that while it is possible to run Modmail with even less memory, Windows 10 itself recommend at least 2GB (4GB for Windows 11). This guide assumes the lowest threshold to comfortably run Modmail without possibly running into any resource bottleneck.
</Callout>

<Callout emoji="⚠️" type="warning">
It is not recommended to run Modmail with previous versions of Windows such as Windows 7 or Windows 8.1 as they no longer receive important security updates, making your hosted applications significantly more prone to security vulnerabilities.
</Callout>

## Dependencies

We will be using the following dependencies:

* Chocolatey
* Python 3.11
* Poetry

To install these dependencies, we will be using Powershell.

Search “powershell” in the Windows start menu, right-click on it and then click “Run as administrator”.

Then run each of the following commands:

```powershell
Set-ExecutionPolicy Bypass -Scope Process -Force
[System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072
iex ((New-Object System.Net.WebClient).DownloadString('https://chocolatey.org/install.ps1'))
choco upgrade git --params "/GitOnlyOnPath /WindowsTerminal" -y
choco upgrade python311 -y
```

Update `pip` and install `pipx` with:
```powershell
py -3.11 -m ensurepip --upgrade
py -3.11 pip install pipx
```

Re-launch your powershell and install Poetry with:
```powershell
pipx install poetry
```

## Installation

In any folder location of your choice, `Shift+Right Click` and click on `Open PowerShell window here`.

In your PowerShell window, run these commands to clone the official Modmail repository locally and `cd` into the folder:

```powershell
git clone https://github.com/raidensakura/modmail
cd modmail
```

Install the Python dependencies for Modmail with:

```powershell
poetry install --no-root
```

Create a new file in the modmail folder named `.env` and paste in your environmental variables needed to run Modmail.

<Image src="/windows-env.png" alt="Hello" width={400} height={500} />
Lastly, in your PowerShell window simply enter the command below to run your Modmail bot:

```powershell
poetry run python bot.py
```

If no error shows up, it means that your Modmail is now running correctly.

## Set up auto-restart

Setting up Modmail on Windows is only intended for development purpose, hence there is no auto-restart method available for Windows OS yet.
You may look into [pm2-installer](https://github.com/jessety/pm2-installer) to use pm2 on Windows.